{
  "version": 3,
  "sources": ["..\\node_modules\\mitt\\dist\\mitt.mjs", "..\\src\\index.ts"],
  "sourcesContent": [
    "export default function(n){return{all:n=n||new Map,on:function(t,e){var i=n.get(t);i?i.push(e):n.set(t,[e])},off:function(t,e){var i=n.get(t);i&&(e?i.splice(i.indexOf(e)>>>0,1):n.set(t,[]))},emit:function(t,e){var i=n.get(t);i&&i.slice().map(function(n){n(e)}),(i=n.get(\"*\"))&&i.slice().map(function(n){n(t,e)})}}}\n//# sourceMappingURL=mitt.mjs.map\n",
    "import mitt, { type Emitter } from 'mitt'\n\nexport function sleep(time: number) {\n    return new Promise<void>(finish => { setTimeout(finish, time) })\n}\n\nexport type CancelableCall = ReturnType<typeof setTimeout>\n\nexport function callSyncAfter(delay: number, fn: () => any): CancelableCall {\n    return setTimeout(fn, delay)\n}\n\nexport function cancelCallSync(handle: CancelableCall) { clearTimeout(handle) }\n\nexport function callAfter<T>(delay: number, fn: () => T) {\n    return new Promise<T>(resolve => { setTimeout(() => resolve(fn()), delay) })\n}\n\nexport type CancelableRepeat = ReturnType<typeof setInterval>\n\nexport interface RepeatOptions {\n    callWhenStart: boolean\n    maxTimes?: number\n}\n\nexport function repeatEvery(\n    delay: number, fn: () => any, opts?: Partial<RepeatOptions>\n): CancelableRepeat {\n    let times = opts?.maxTimes\n    if (opts?.callWhenStart) {\n        setTimeout(fn, 0)\n        if (times) times -= 1\n    }\n    if (times === undefined) return setInterval(fn, delay)\n    if (times < 1) return undefined as any\n    const handle = setInterval(() => {\n        if (--times! < 0) clearInterval(handle)\n        else fn()\n    }, delay)\n    return handle\n}\n\nexport function cancelRepeat(handle: CancelableRepeat) { clearInterval(handle) }\n\nexport function loop(times: number, fn: () => any) { for (let i = times; i > 0; --i) fn() }\n\nexport interface TimerOptions extends RepeatOptions {\n    repeat: boolean\n}\n\nexport class Timer<T> implements TimerOptions {\n    static defaultOptions: TimerOptions = {\n        repeat: false,\n        callWhenStart: false,\n    }\n\n    delay\n    fn\n    repeat\n    callWhenStart\n    maxTimes\n\n    constructor(delay: number, fn?: () => T, options?: Partial<TimerOptions>) {\n        this.delay = delay\n        this.fn = fn\n        const opt = { ...Timer.defaultOptions, ...options }\n        this.repeat = opt.repeat\n        this.callWhenStart = opt.callWhenStart\n        this.maxTimes = opt.maxTimes\n    }\n\n    get running() { return Boolean(this.#handle) }\n    set running(to) { to ? this.start() : this.stop() }\n    get events() { return this.#emitter }\n    get callTimes() { return this.#callTimes }\n    get remainTimes() { return this.maxTimes ? this.maxTimes - this.#callTimes : 0 }\n    get hasMoreTrigger() {\n        return this.repeat && (this.maxTimes === undefined || this.#callTimes < this.maxTimes - 1)\n    }\n\n    start() {\n        if (this.#handle) return this\n        this.#callTimes = 0\n        this.#emitter.emit('running-changed', true)\n        return this.#start()\n    }\n\n    stop() {\n        if (!this.#handle) return\n        clearTimeout(this.#handle)\n        this.#emitter.emit('running-changed', false)\n        this.#stop()\n    }\n\n    reset() {\n        this.#callTimes = 0\n        if (!this.#handle) return\n        clearTimeout(this.#handle)\n        return this.#start()\n    }\n\n    restart() {\n        this.stop()\n        return this.start()\n    }\n\n    waitTriggered() {\n        return new Promise<T>((resolve, reject) => {\n            this.#triggerResolvers.push(resolve)\n            this.#triggerRejectors.push(reject)\n        })\n    }\n\n    waitStop() { return new Promise<void>(resolve => this.#stopResolvers.push(resolve)) }\n\n    #callTimes = 0\n    #handle?: ReturnType<typeof setTimeout>\n    #triggerResolvers: ((result: T) => void)[] = []\n    #triggerRejectors: ((reason: any) => void)[] = []\n    #stopResolvers: (() => void)[] = []\n    #emitter: Emitter<{ 'running-changed': boolean, 'triggered': T }> = mitt()\n\n    #call() {\n        this.#callTimes += 1\n        try {\n            const value = this.fn?.() as T\n            for (const resolve of this.#triggerResolvers) resolve(value)\n            this.#emitter.emit('triggered', value)\n        } catch (e) {\n            for (const reject of this.#triggerRejectors) reject(e)\n        } finally {\n            this.#triggerResolvers.length = this.#triggerRejectors.length = 0\n            if (!this.hasMoreTrigger) this.#stop()\n        }\n    }\n\n    #tigger() {\n        if (this.hasMoreTrigger) this.#createHandle()\n        this.#call()\n    }\n\n    #createHandle() { this.#handle = setTimeout(this.#tigger.bind(this), this.delay) }\n\n    #start() {\n        if (this.callWhenStart) setTimeout(() => this.#call(), 0)\n        if (!this.callWhenStart || (this.maxTimes ?? 3) >= 2) this.#createHandle()\n        return this\n    }\n\n    #stop() {\n        this.#handle = undefined\n        for (const reject of this.#triggerRejectors) reject(new Error('Timer stopped'))\n        this.#triggerResolvers.length = this.#triggerRejectors.length = 0\n        for (const resolve of this.#stopResolvers) resolve()\n        this.#stopResolvers.length = 0\n    }\n}"
  ],
  "mappings": "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",
  "debugId": "6077F25D64A49AA164756E2164756E21",
  "names": []
}